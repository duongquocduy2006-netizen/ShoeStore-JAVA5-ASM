<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Admin Poly - Dashboard</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" th:href="@{/css/admin-style.css}">
</head>
<body>
    <div class="admin-wrapper">
        <aside th:replace="~{admin/fragments/sidebar :: sidebar}"></aside>

        <div class="main-content">
            <header th:replace="~{admin/fragments/header :: header}"></header>

            <main class="content-body">
                <div class="admin-container">
                    <div class="dashboard-header">
                        <div class="header-left">
                            <h2 class="dashboard-title">Tổng Quan Kinh Doanh</h2>
                            <p class="text-muted">Cập nhật lúc: <span id="current-time-now"></span></p>
                        </div>
                        <div class="header-right">
                            <select class="period-select">
                                <option>Tháng này</option>
                                <option>Quý này</option>
                                <option>Năm nay</option>
                            </select>
                            <button class="btn-primary-custom">
                                <i class="bi bi-download"></i> Xuất báo cáo
                            </button>
                        </div>
                    </div>

                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon purple"><i class="bi bi-currency-dollar"></i></div>
                            <div class="stat-info">
                                <p class="stat-label">Doanh thu tháng</p>
                                <h3 class="stat-value">1.25 Tỷ ₫</h3>
                                <span class="stat-trend up"><i class="bi bi-arrow-up-short"></i> 12.5%</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon blue"><i class="bi bi-bag-check-fill"></i></div>
                            <div class="stat-info">
                                <p class="stat-label">Đơn hàng mới</p>
                                <h3 class="stat-value">2,450</h3>
                                <span class="stat-trend down"><i class="bi bi-arrow-down-short"></i> 3.2%</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon orange"><i class="bi bi-box-seam-fill"></i></div>
                            <div class="stat-info">
                                <p class="stat-label">Cần nhập hàng</p>
                                <h3 class="stat-value">35 SP</h3>
                                <span class="stat-trend neutral">Kho thấp</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon green"><i class="bi bi-people-fill"></i></div>
                            <div class="stat-info">
                                <p class="stat-label">Khách hàng mới</p>
                                <h3 class="stat-value">+480</h3>
                                <span class="stat-trend up"><i class="bi bi-arrow-up-short"></i> 8.4%</span>
                            </div>
                        </div>
                    </div>

                    <div class="dashboard-grid-main">
                        <div class="card-box chart-container">
                            <div class="card-header-flex">
                                <h5 class="card-title">Biểu đồ doanh thu 12 tháng</h5>
                                <div class="chart-legend"><span class="dot-revenue"></span> Doanh thu</div>
                            </div>
                            <div class="bar-chart-wrapper">
                                <div class="y-axis">
                                    <span>2 Tỷ</span><span>1.5 Tỷ</span><span>1 Tỷ</span><span>500 Tr</span><span>0</span>
                                </div>
                                <div class="bars-area">
                                    <div th:each="item : ${revenueData}" class="bar-group">
                                        <div class="bar-fill" th:style="'height:' + ${item.percent} + '%'">
                                            <div class="tooltip" th:text="${item.value}"></div>
                                        </div>
                                        <span class="x-label" th:text="${item.month}"></span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card-box category-container">
                            <h5 class="card-title">Xu hướng danh mục</h5>
                            <div class="category-list">
                                <div th:each="cat : ${categoryTrends}" class="cat-item">
                                    <div class="cat-header">
                                        <span class="cat-name"><i th:class="${cat.icon}"></i> [[${cat.name}]]</span>
                                        <span class="cat-value">[[${cat.value}]]%</span>
                                    </div>
                                    <div class="progress-bar-bg">
                                        <div class="progress-bar-fill" th:classappend="${cat.trend}" th:style="'width:' + ${cat.value} + '%'"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="dashboard-grid-bottom">
                        <div class="card-box">
                            <div class="card-header-flex">
                                <h5 class="card-title">Top Sản Phẩm Bán Chạy</h5>
                                <a href="#" class="view-all">Xem tất cả</a>
                            </div>
                            <table class="simple-table">
                                <thead>
                                    <tr>
                                        <th>Sản phẩm</th><th>Danh mục</th><th class="text-right">Đã bán</th><th class="text-right">Doanh thu</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr th:each="prod, state : ${products}">
                                        <td>
                                            <div class="prod-cell">
                                                <span class="rank-badge" th:classappend="'rank-' + ${state.count}" th:text="${state.count}"></span>
                                                <img th:src="${prod.image}" class="prod-img">
                                                <span class="fw-bold" th:text="${prod.name}"></span>
                                            </div>
                                        </td>
                                        <td><span class="badge-gray" th:text="${prod.category}"></span></td>
                                        <td class="text-right fw-bold" th:text="${prod.sales}"></td>
                                        <td class="text-right text-blue" th:text="${prod.revenue}"></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <div class="card-box">
                            <h5 class="card-title">Hoạt động gần đây</h5>
                            <div class="timeline">
                                <div th:each="act : ${activities}" class="timeline-item">
                                    <div class="timeline-dot" th:classappend="${act.type}"></div>
                                    <div class="timeline-content">
                                        <p class="timeline-text" th:utext="${act.text}"></p>
                                        <span class="timeline-time" th:text="${act.time}"></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>
    
    <script th:src="@{/js/admin-main.js}"></script>
</body>
</html>